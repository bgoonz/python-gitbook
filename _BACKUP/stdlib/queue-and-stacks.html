<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>queue-and-stacks</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
</head>
<body>
<h1 id="queue-stacks">Queue &amp; Stacks</h1>
<p>If you often work with lists in Python, then you probably know that they don’t perform fast enough when you need to <strong>pop</strong> and <strong>append</strong> items on their left end. Python’s <a href="https://docs.python.org/3/library/collections.html#module-collections"><code>collections</code></a> module provides a class called <a href="https://docs.python.org/3/library/collections.html#collections.deque"><code>deque</code></a> that’s specially designed to provide fast and memory-efficient ways to append and pop item from both ends of the underlying data structure.</p>
<p>Python’s <code>deque</code> is a low-level and highly optimized <a href="https://en.wikipedia.org/wiki/Double-ended_queue">double-ended queue</a> that’s useful for implementing elegant, efficient, and Pythonic queues and stacks, which are the most common list-like data types in computing.</p>
<p><strong>In this tutorial, you’ll learn:</strong></p>
<ul>
<li>How to create and use Python’s <strong><code>deque</code></strong> in your code</li>
<li>How to efficiently <strong>append</strong> and <strong>pop</strong> items from both ends of a <code>deque</code></li>
<li>How to use <code>deque</code> to build efficient <strong>queues</strong> and <strong>stacks</strong></li>
<li>When it’s worth using <strong><code>deque</code></strong> instead of <strong><code>list</code></strong></li>
</ul>
<p>To better understand these topics, you should know the basics of working with Python <a href="https://realpython.com/python-lists-tuples/">lists</a>. It’ll also be beneficial for you to have a general understanding of <a href="https://realpython.com/python-data-structures/#queues-fifos">queues</a> and <a href="https://realpython.com/how-to-implement-python-stack/">stacks</a>.</p>
<p>Finally, you’ll write a few examples that walk you through some common use cases of <code>deque</code>, which is one of Python’s most powerful data types.</p>
<p><strong>Free Bonus:</strong> <a href="https://realpython.com/bonus/python-tricks-sample/">Click here to get access to a chapter from Python Tricks: The Book</a> that shows you Python’s best practices with simple examples you can apply instantly to write more beautiful + Pythonic code.</p>
<h3 id="getting-started-with-pythons-deque">Getting Started With Python’s <code>deque</code></h3>
<p>Appending items to and popping them from the right end of a Python list are normally efficient operations. If you use the <a href="https://en.wikipedia.org/wiki/Big_O_notation">Big O notation</a> for <a href="https://wiki.python.org/moin/TimeComplexity">time complexity</a>, then you can say that they’re <em>O</em>(1). However, when Python needs to reallocate memory to grow the underlying list for accepting new items, these operations are slower and can become <em>O</em>(<em>n</em>).</p>
<p>Additionally, appending and popping items on the left end of a Python list are known to be inefficient operations with <em>O</em>(<em>n</em>) speed.</p>
<p>Since Python lists provide both operations with <a href="https://realpython.com/python-append/"><code>.append()</code></a> and <code>.pop()</code>, they’re usable as <a href="https://en.wikipedia.org/wiki/Stack_%28abstract_data_type%29">stacks</a> and <a href="https://en.wikipedia.org/wiki/Queue_%28abstract_data_type%29">queues</a>. However, the performance issues you saw before can significantly affect the overall performance of your applications.</p>
<p>Python’s <a href="https://docs.python.org/3/library/collections.html?highlight=collections#collections.deque"><code>deque</code></a> was the first data type added to the <a href="https://realpython.com/python-collections-module/"><code>collections</code></a> module back in <a href="https://docs.python.org/3/whatsnew/2.4.html#new-improved-and-deprecated-modules">Python 2.4</a>. This data type was specially designed to overcome the efficiency problems of <code>.append()</code> and <code>.pop()</code> in Python list.</p>
<p>Deques are sequence-like data types designed as a generalization of <strong>stacks</strong> and <strong>queues</strong>. They support memory-efficient and fast append and pop operations on both ends of the data structure.</p>
<p><strong>Note:</strong> <code>deque</code> is pronounced as “deck.” The name stands for <a href="https://en.wikipedia.org/wiki/Double-ended_queue"><strong>d</strong>ouble-<strong>e</strong>nded <strong>que</strong>ue</a>.</p>
<p>Append and pop operations on both ends of a <code>deque</code> object are stable and equally efficient because deques are <a href="https://github.com/python/cpython/blob/23acadcc1c75eb74b2459304af70d97a35001b34/Modules/_collectionsmodule.c#L34">implemented</a> as a <a href="https://realpython.com/linked-lists-python/#how-to-use-doubly-linked-lists">doubly linked list</a>. Additionally, append and pop operations on deques are also <a href="https://en.wikipedia.org/wiki/Thread_safety">thread safe</a> and memory efficient. These features make deques particularly useful for creating custom stacks and queues in Python.</p>
<p>Deques are also the way to go if you need to keep a list of last-seen items because you can restrict the maximum length of your deques. If you do so, then once a deque is full, it automatically discards items from one end when you append new items on the opposite end.</p>
<p>Here’s a summary of the main characteristics of <code>deque</code>:</p>
<ul>
<li>Stores items of any <a href="https://realpython.com/python-data-types/">data type</a></li>
<li>Is a <a href="https://docs.python.org/3/glossary.html#term-mutable">mutable</a> data type</li>
<li>Supports <a href="https://realpython.com/python-boolean/#the-in-operator">membership operations</a> with the <code>in</code> operator</li>
<li>Supports <a href="https://realpython.com/python-lists-tuples/#list-elements-can-be-accessed-by-index">indexing</a>, like in <code>a_deque[i]</code></li>
<li>Doesn’t support slicing, like in <code>a_deque[0:2]</code></li>
<li>Supports built-in functions that operate on sequences and iterables, such as <a href="https://docs.python.org/3/library/functions.html#len"><code>len()</code></a>, <a href="https://realpython.com/python-sort/"><code>sorted()</code></a>, <a href="https://realpython.com/python-reverse-list/"><code>reversed()</code></a>, and more</li>
<li>Doesn’t support <a href="https://en.wikipedia.org/wiki/In-place_algorithm">in-place</a> sorting</li>
<li>Supports normal and reverse iteration</li>
<li>Supports pickling with <a href="https://realpython.com/python-pickle-module/"><code>pickle</code></a></li>
<li>Ensures fast, memory-efficient, and thread-safe pop and append operations on both ends</li>
</ul>
<p>Creating <code>deque</code> instances is a straightforward process. You just need to import <code>deque</code> from <code>collections</code> and call it with an optional <code>iterable</code> as an argument:&gt;&gt;&gt;</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb1-1" title="1"><span class="op">&gt;&gt;&gt;</span> <span class="im">from</span> collections <span class="im">import</span> deque</a>
<a class="sourceLine" id="cb1-2" title="2"></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="op">&gt;&gt;&gt;</span> <span class="co"># Create an empty deque</span></a>
<a class="sourceLine" id="cb1-4" title="4"><span class="op">&gt;&gt;&gt;</span> deque()</a>
<a class="sourceLine" id="cb1-5" title="5">deque([])</a>
<a class="sourceLine" id="cb1-6" title="6"></a>
<a class="sourceLine" id="cb1-7" title="7"><span class="op">&gt;&gt;&gt;</span> <span class="co"># Use different iterables to create deques</span></a>
<a class="sourceLine" id="cb1-8" title="8"><span class="op">&gt;&gt;&gt;</span> deque((<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>))</a>
<a class="sourceLine" id="cb1-9" title="9">deque([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>])</a>
<a class="sourceLine" id="cb1-10" title="10"></a>
<a class="sourceLine" id="cb1-11" title="11"><span class="op">&gt;&gt;&gt;</span> deque([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>])</a>
<a class="sourceLine" id="cb1-12" title="12">deque([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>])</a>
<a class="sourceLine" id="cb1-13" title="13"></a>
<a class="sourceLine" id="cb1-14" title="14"><span class="op">&gt;&gt;&gt;</span> deque(<span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">5</span>))</a>
<a class="sourceLine" id="cb1-15" title="15">deque([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>])</a>
<a class="sourceLine" id="cb1-16" title="16"></a>
<a class="sourceLine" id="cb1-17" title="17"><span class="op">&gt;&gt;&gt;</span> deque(<span class="st">&quot;abcd&quot;</span>)</a>
<a class="sourceLine" id="cb1-18" title="18">deque([<span class="st">&#39;a&#39;</span>, <span class="st">&#39;b&#39;</span>, <span class="st">&#39;c&#39;</span>, <span class="st">&#39;d&#39;</span>])</a>
<a class="sourceLine" id="cb1-19" title="19"></a>
<a class="sourceLine" id="cb1-20" title="20"><span class="op">&gt;&gt;&gt;</span> numbers <span class="op">=</span> {<span class="st">&quot;one&quot;</span>: <span class="dv">1</span>, <span class="st">&quot;two&quot;</span>: <span class="dv">2</span>, <span class="st">&quot;three&quot;</span>: <span class="dv">3</span>, <span class="st">&quot;four&quot;</span>: <span class="dv">4</span>}</a>
<a class="sourceLine" id="cb1-21" title="21"><span class="op">&gt;&gt;&gt;</span> deque(numbers.keys())</a>
<a class="sourceLine" id="cb1-22" title="22">deque([<span class="st">&#39;one&#39;</span>, <span class="st">&#39;two&#39;</span>, <span class="st">&#39;three&#39;</span>, <span class="st">&#39;four&#39;</span>])</a>
<a class="sourceLine" id="cb1-23" title="23"></a>
<a class="sourceLine" id="cb1-24" title="24"><span class="op">&gt;&gt;&gt;</span> deque(numbers.values())</a>
<a class="sourceLine" id="cb1-25" title="25">deque([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>])</a>
<a class="sourceLine" id="cb1-26" title="26"></a>
<a class="sourceLine" id="cb1-27" title="27"><span class="op">&gt;&gt;&gt;</span> deque(numbers.items())</a>
<a class="sourceLine" id="cb1-28" title="28">deque([(<span class="st">&#39;one&#39;</span>, <span class="dv">1</span>), (<span class="st">&#39;two&#39;</span>, <span class="dv">2</span>), (<span class="st">&#39;three&#39;</span>, <span class="dv">3</span>), (<span class="st">&#39;four&#39;</span>, <span class="dv">4</span>)])</a></code></pre></div>
<p>If you instantiate <code>deque</code> without providing an <code>iterable</code> as an argument, then you get an empty deque. If you provide and input <code>iterable</code>, then <code>deque</code> initializes the new instance with data from it. The initialization goes from left to right using <a href="https://docs.python.org/3/library/collections.html#collections.deque.append"><code>deque.append()</code></a>.</p>
<p>The <code>deque</code> initializer takes the following two optional arguments:</p>
<ol type="1">
<li><strong><code>iterable</code></strong> holds an iterable that provides the initialization data.</li>
<li><strong><code>maxlen</code></strong> holds an integer <a href="https://realpython.com/python-numbers/">number</a> that specifies the maximum length of the deque.</li>
</ol>
<p>As mentioned previously, if you don’t supply an <code>iterable</code>, then you get an empty deque. If you supply a value to <a href="https://docs.python.org/3/library/collections.html#collections.deque.maxlen"><code>maxlen</code></a>, then your deque will only store up to <code>maxlen</code> items.</p>
<p>Finally, you can also use unordered iterables, such as <a href="https://realpython.com/python-sets/">sets</a>, to initialize your deques. In those cases, you won’t have a predefined order for the items in the final deque.<a href="https://srv.realpython.net/click/5212255200/?c=56207115366&amp;p=58946116052&amp;r=72620"><img src="https://img.realpython.net/655d5b5272a07eaebc6a0885e3bc64ec" /></a><a href="https://realpython.com/account/join/">Remove ads</a></p>
<h3 id="popping-and-appending-items-efficiently">Popping and Appending Items Efficiently</h3>
<p>The most important difference between <code>deque</code> and <code>list</code> is that the former allows you to perform efficient append and pop operations on both ends of the sequence. The <code>deque</code> class implements dedicated <a href="https://docs.python.org/3/library/collections.html#collections.deque.popleft"><code>.popleft()</code></a> and <a href="https://docs.python.org/3/library/collections.html#collections.deque.appendleft"><code>.appendleft()</code></a> methods that operate on the left end of the sequence directly:&gt;&gt;&gt;</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb2-1" title="1"><span class="op">&gt;&gt;&gt;</span> <span class="im">from</span> collections <span class="im">import</span> deque</a>
<a class="sourceLine" id="cb2-2" title="2"></a>
<a class="sourceLine" id="cb2-3" title="3"><span class="op">&gt;&gt;&gt;</span> numbers <span class="op">=</span> deque([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>])</a>
<a class="sourceLine" id="cb2-4" title="4"><span class="op">&gt;&gt;&gt;</span> numbers.popleft()</a>
<a class="sourceLine" id="cb2-5" title="5"><span class="dv">1</span></a>
<a class="sourceLine" id="cb2-6" title="6"><span class="op">&gt;&gt;&gt;</span> numbers.popleft()</a>
<a class="sourceLine" id="cb2-7" title="7"><span class="dv">2</span></a>
<a class="sourceLine" id="cb2-8" title="8"><span class="op">&gt;&gt;&gt;</span> numbers</a>
<a class="sourceLine" id="cb2-9" title="9">deque([<span class="dv">3</span>, <span class="dv">4</span>])</a>
<a class="sourceLine" id="cb2-10" title="10"></a>
<a class="sourceLine" id="cb2-11" title="11"><span class="op">&gt;&gt;&gt;</span> numbers.appendleft(<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb2-12" title="12"><span class="op">&gt;&gt;&gt;</span> numbers.appendleft(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb2-13" title="13"><span class="op">&gt;&gt;&gt;</span> numbers</a>
<a class="sourceLine" id="cb2-14" title="14">deque([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>])</a></code></pre></div>
<p>Here, you use <code>.popleft()</code> and <code>.appendleft()</code> to remove and add values, respectively, to the left end of <code>numbers</code>. These methods are specific to the design of <code>deque</code>, and you won’t find them in <code>list</code>.</p>
<p>Just like <code>list</code>, <code>deque</code> also provides <code>.append()</code> and <a href="https://docs.python.org/3/library/collections.html#collections.deque.pop"><code>.pop()</code></a> methods to operate on the right end of the sequence. However, <code>.pop()</code> behaves differently:&gt;&gt;&gt;</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb3-1" title="1"><span class="op">&gt;&gt;&gt;</span> <span class="im">from</span> collections <span class="im">import</span> deque</a>
<a class="sourceLine" id="cb3-2" title="2"></a>
<a class="sourceLine" id="cb3-3" title="3"><span class="op">&gt;&gt;&gt;</span> numbers <span class="op">=</span> deque([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>])</a>
<a class="sourceLine" id="cb3-4" title="4"><span class="op">&gt;&gt;&gt;</span> numbers.pop()</a>
<a class="sourceLine" id="cb3-5" title="5"><span class="dv">4</span></a>
<a class="sourceLine" id="cb3-6" title="6"></a>
<a class="sourceLine" id="cb3-7" title="7"><span class="op">&gt;&gt;&gt;</span> numbers.pop(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb3-8" title="8">Traceback (most recent call last):</a>
<a class="sourceLine" id="cb3-9" title="9">  File <span class="st">&quot;&lt;stdin&gt;&quot;</span>, line <span class="dv">1</span>, <span class="kw">in</span> <span class="op">&lt;</span>module<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb3-10" title="10"><span class="pp">TypeError</span>: pop() takes no arguments (<span class="dv">1</span> given)</a></code></pre></div>
<p>Here, <code>.pop()</code> removes and returns the last value in the deque. The method doesn’t take an index as an argument, so you can’t use it to remove arbitrary items from your deques. You can only use it to remove and return the rightmost item.</p>
<p>As you learned earlier, <code>deque</code> is implemented as a <strong>doubly linked list</strong>. So, every item in a given deque holds a reference (<a href="https://realpython.com/pointers-in-python/">pointer</a>) to the next and previous item in the sequence.</p>
<p>Doubly linked lists make appending and popping items from either end light and efficient operations. That’s possible because only the pointers need to be updated. As a result, both operations have similar performance, <em>O</em>(1). They’re also predictable performance-wise because there’s no need for reallocating memory and moving existing items to accept new ones.</p>
<p>Appending and popping items from the left end of a regular Python list requires shifting all the items, which ends up being an <em>O</em>(<em>n</em>) operation. Additionally, adding items to the right end of a list often requires Python to reallocate memory and copy the current items to the new memory location. After that, it can add the new items. This process takes longer to complete, and the append operation passes from being <em>O</em>(1) to <em>O</em>(<em>n</em>).</p>
<p>Consider the following performance tests for appending items to the left end of a sequence, <code>deque</code> vs <code>list</code>:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb4-1" title="1"><span class="co"># time_append.py</span></a>
<a class="sourceLine" id="cb4-2" title="2"></a>
<a class="sourceLine" id="cb4-3" title="3"><span class="im">from</span> collections <span class="im">import</span> deque</a>
<a class="sourceLine" id="cb4-4" title="4"><span class="im">from</span> time <span class="im">import</span> perf_counter</a>
<a class="sourceLine" id="cb4-5" title="5"></a>
<a class="sourceLine" id="cb4-6" title="6">TIMES <span class="op">=</span><span class="dv"> 10_000</span></a>
<a class="sourceLine" id="cb4-7" title="7">a_list <span class="op">=</span> []</a>
<a class="sourceLine" id="cb4-8" title="8">a_deque <span class="op">=</span> deque()</a>
<a class="sourceLine" id="cb4-9" title="9"></a>
<a class="sourceLine" id="cb4-10" title="10"><span class="kw">def</span> average_time(func, times):</a>
<a class="sourceLine" id="cb4-11" title="11">    total <span class="op">=</span> <span class="fl">0.0</span></a>
<a class="sourceLine" id="cb4-12" title="12">    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(times):</a>
<a class="sourceLine" id="cb4-13" title="13">        start <span class="op">=</span> perf_counter()</a>
<a class="sourceLine" id="cb4-14" title="14">        func(i)</a>
<a class="sourceLine" id="cb4-15" title="15">        total <span class="op">+=</span> (perf_counter() <span class="op">-</span> start) <span class="op">*</span> <span class="fl">1e9</span></a>
<a class="sourceLine" id="cb4-16" title="16">    <span class="cf">return</span> total <span class="op">/</span> times</a>
<a class="sourceLine" id="cb4-17" title="17"></a>
<a class="sourceLine" id="cb4-18" title="18">list_time <span class="op">=</span> average_time(<span class="kw">lambda</span> i: a_list.insert(<span class="dv">0</span>, i), TIMES)</a>
<a class="sourceLine" id="cb4-19" title="19">deque_time <span class="op">=</span> average_time(<span class="kw">lambda</span> i: a_deque.appendleft(i), TIMES)</a>
<a class="sourceLine" id="cb4-20" title="20">gain <span class="op">=</span> list_time <span class="op">/</span> deque_time</a>
<a class="sourceLine" id="cb4-21" title="21"></a>
<a class="sourceLine" id="cb4-22" title="22"><span class="bu">print</span>(<span class="ss">f&quot;list.insert()      </span><span class="sc">{</span>list_time<span class="sc">:.6}</span><span class="ss"> ns&quot;</span>)</a>
<a class="sourceLine" id="cb4-23" title="23"><span class="bu">print</span>(<span class="ss">f&quot;deque.appendleft() </span><span class="sc">{</span>deque_time<span class="sc">:.6}</span><span class="ss"> ns  (</span><span class="sc">{</span>gain<span class="sc">:.6}</span><span class="ss">x faster)&quot;</span>)</a></code></pre></div>
<p>In this script, <code>average_time()</code> computes the average time that executing a function (<code>func</code>) a given number of <code>times</code> takes. If you <a href="https://realpython.com/run-python-scripts/">run the script</a> from your command line, then you get the following output:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb5-1" title="1">$ python time_append.py</a>
<a class="sourceLine" id="cb5-2" title="2"><span class="bu">list</span>.insert()      <span class="fl">3735.08</span> ns</a>
<a class="sourceLine" id="cb5-3" title="3">deque.appendleft() <span class="fl">238.889</span> ns  (<span class="fl">15.6352</span>x faster)</a></code></pre></div>
<p>In this specific example, <code>.appendleft()</code> on a <code>deque</code> is several times faster than <code>.insert()</code> on a <code>list</code>. Note that <code>deque.appendleft()</code> is <em>O</em>(1), which means that the execution time is constant. However, <code>list.insert()</code> on the left end of the list is <em>O</em>(<em>n</em>), which means that the execution time depends on the number of items to process.</p>
<p>In this example, if you increment the value of <code>TIMES</code>, then you’ll get higher time measurements for <code>list.insert()</code> but stable (constant) results for <code>deque.appendleft()</code>. If you’d like to try a similar performance test on pop operations for both deques and lists, then you can expand the exercise block below and compare your results to <em>Real Python</em>‘s after you’re done.</p>
<p>Exercise: Test <code>deque.popleft()</code> vs <code>list.pop(0)</code> performanceShow/Hide</p>
<p>Solution: Test <code>deque.popleft()</code> vs <code>list.pop(0)</code> performanceShow/Hide</p>
<p>The <code>deque</code> data type was designed to guarantee efficient append and pop operations on either end of the sequence. It’s ideal for approaching problems that require the implementation of queue and stack data structures in Python.</p>
<h3 id="accessing-random-items-in-a-deque">Accessing Random Items in a <code>deque</code></h3>
<p>Python’s <code>deque</code> returns mutable sequences that work quite similarly to lists. Besides allowing you to append and pop items from their ends efficiently, deques provide a group of list-like methods and other sequence-like operations to work with items at arbitrary locations. Here are some of them:</p>
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Option</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><a href="https://docs.python.org/3/library/collections.html#collections.deque.insert"><code>.insert(i, value)</code></a></td>
<td style="text-align: left;">Insert an item <code>value</code> into a deque at index <code>i</code>.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><a href="https://docs.python.org/3/library/collections.html#collections.deque.remove"><code>.remove(value)</code></a></td>
<td style="text-align: left;">Remove the first occurrence of <code>value</code>, raising <a href="https://docs.python.org/3/library/exceptions.html#ValueError"><code>ValueError</code></a> if the <code>value</code> doesn’t exist.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><a href="https://docs.python.org/3/library/stdtypes.html#common-sequence-operations"><code>a_deque[i]</code></a></td>
<td style="text-align: left;">Retrieve the item at index <code>i</code> from a deque.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><a href="https://docs.python.org/3/library/stdtypes.html#immutable-sequence-types"><code>del a_deque[i]</code></a></td>
<td style="text-align: left;">Remove the item at index <code>i</code> from a deque.</td>
</tr>
</tbody>
</table>
<p>You can use these methods and techniques to work with items at any position inside a <code>deque</code> object. Here’s how to do that:&gt;&gt;&gt;</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb6-1" title="1"><span class="op">&gt;&gt;&gt;</span> <span class="im">from</span> collections <span class="im">import</span> deque</a>
<a class="sourceLine" id="cb6-2" title="2"></a>
<a class="sourceLine" id="cb6-3" title="3"><span class="op">&gt;&gt;&gt;</span> letters <span class="op">=</span> deque(<span class="st">&quot;abde&quot;</span>)</a>
<a class="sourceLine" id="cb6-4" title="4"></a>
<a class="sourceLine" id="cb6-5" title="5"><span class="op">&gt;&gt;&gt;</span> letters.insert(<span class="dv">2</span>, <span class="st">&quot;c&quot;</span>)</a>
<a class="sourceLine" id="cb6-6" title="6"><span class="op">&gt;&gt;&gt;</span> letters</a>
<a class="sourceLine" id="cb6-7" title="7">deque([<span class="st">&#39;a&#39;</span>, <span class="st">&#39;b&#39;</span>, <span class="st">&#39;c&#39;</span>, <span class="st">&#39;d&#39;</span>, <span class="st">&#39;e&#39;</span>])</a>
<a class="sourceLine" id="cb6-8" title="8"></a>
<a class="sourceLine" id="cb6-9" title="9"><span class="op">&gt;&gt;&gt;</span> letters.remove(<span class="st">&quot;d&quot;</span>)</a>
<a class="sourceLine" id="cb6-10" title="10"><span class="op">&gt;&gt;&gt;</span> letters</a>
<a class="sourceLine" id="cb6-11" title="11">deque([<span class="st">&#39;a&#39;</span>, <span class="st">&#39;b&#39;</span>, <span class="st">&#39;c&#39;</span>, <span class="st">&#39;e&#39;</span>])</a>
<a class="sourceLine" id="cb6-12" title="12"></a>
<a class="sourceLine" id="cb6-13" title="13"><span class="op">&gt;&gt;&gt;</span> letters[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb6-14" title="14"><span class="co">&#39;b&#39;</span></a>
<a class="sourceLine" id="cb6-15" title="15"></a>
<a class="sourceLine" id="cb6-16" title="16"><span class="op">&gt;&gt;&gt;</span> <span class="kw">del</span> letters[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb6-17" title="17"><span class="op">&gt;&gt;&gt;</span> letters</a>
<a class="sourceLine" id="cb6-18" title="18">deque([<span class="st">&#39;a&#39;</span>, <span class="st">&#39;b&#39;</span>, <span class="st">&#39;e&#39;</span>])</a></code></pre></div>
<p>Here, you first insert <code>"c"</code> into <code>letters</code> at position <code>2</code>. Then you remove <code>"d"</code> from the deque using <code>.remove()</code>. Deques also allow <strong>indexing</strong> to access items, which you use here to access <code>"b"</code> at index <code>1</code>. Finally, you can use the <code>del</code> <a href="https://realpython.com/python-keywords/">keyword</a> to delete any existing items from a deque. Note that <code>.remove()</code> lets you delete items <em>by value</em>, while <code>del</code> removes items <em>by index</em>.</p>
<p>Even though <code>deque</code> objects support indexing, they don’t support <strong>slicing</strong>. In other words, you can’t extract a <a href="https://docs.python.org/3/glossary.html#term-slice">slice</a> from an existing deque using the <a href="https://docs.python.org/3/whatsnew/2.3.html?highlight=slicing#extended-slices">slicing syntax</a>, <code>[start:stop:step]</code>, as you would with a regular list:&gt;&gt;&gt;</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb7-1" title="1"><span class="op">&gt;&gt;&gt;</span> <span class="im">from</span> collections <span class="im">import</span> deque</a>
<a class="sourceLine" id="cb7-2" title="2"></a>
<a class="sourceLine" id="cb7-3" title="3"><span class="op">&gt;&gt;&gt;</span> numbers <span class="op">=</span> deque([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>])</a>
<a class="sourceLine" id="cb7-4" title="4"></a>
<a class="sourceLine" id="cb7-5" title="5"><span class="op">&gt;&gt;&gt;</span> numbers[<span class="dv">1</span>:<span class="dv">3</span>]</a>
<a class="sourceLine" id="cb7-6" title="6">Traceback (most recent call last):</a>
<a class="sourceLine" id="cb7-7" title="7">  File <span class="st">&quot;&lt;stdin&gt;&quot;</span>, line <span class="dv">1</span>, <span class="kw">in</span> <span class="op">&lt;</span>module<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb7-8" title="8"><span class="pp">TypeError</span>: sequence index must be integer, <span class="kw">not</span> <span class="st">&#39;slice&#39;</span></a></code></pre></div>
<p>Deques support indexing, but interestingly, they don’t support slicing. When you try to get a slice from a deque, you get a <code>TypeError</code>. In general, performing a slicing on a linked list would be inefficient, so the operation isn’t available.</p>
<p>So far, you’ve seen that <code>deque</code> is quite similar to <code>list</code>. However, while <code>list</code> is based on <a href="https://en.wikipedia.org/wiki/Array_data_structure">arrays</a>, <code>deque</code> is based on a doubly linked list.</p>
<p>There is a hidden cost behind <code>deque</code> being implemented as a doubly linked list: accessing, inserting, and removing arbitrary items aren’t efficient operations. To perform them, the <a href="https://realpython.com/interacting-with-python/#starting-the-interpreter">interpreter</a> has to iterate through the deque until it gets to the desired item. So, they’re <em>O</em>(<em>n</em>) instead of <em>O</em>(1) operations.</p>
<p>Here’s a script that shows how deques and lists behave when it comes to working with arbitrary items:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb8-1" title="1"><span class="co"># time_random_access.py</span></a>
<a class="sourceLine" id="cb8-2" title="2"></a>
<a class="sourceLine" id="cb8-3" title="3"><span class="im">from</span> collections <span class="im">import</span> deque</a>
<a class="sourceLine" id="cb8-4" title="4"><span class="im">from</span> time <span class="im">import</span> perf_counter</a>
<a class="sourceLine" id="cb8-5" title="5"></a>
<a class="sourceLine" id="cb8-6" title="6">TIMES <span class="op">=</span><span class="dv"> 10_000</span></a>
<a class="sourceLine" id="cb8-7" title="7">a_list <span class="op">=</span> [<span class="dv">1</span>] <span class="op">*</span> TIMES</a>
<a class="sourceLine" id="cb8-8" title="8">a_deque <span class="op">=</span> deque(a_list)</a>
<a class="sourceLine" id="cb8-9" title="9"></a>
<a class="sourceLine" id="cb8-10" title="10"><span class="kw">def</span> average_time(func, times):</a>
<a class="sourceLine" id="cb8-11" title="11">    total <span class="op">=</span> <span class="fl">0.0</span></a>
<a class="sourceLine" id="cb8-12" title="12">    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(times):</a>
<a class="sourceLine" id="cb8-13" title="13">        start <span class="op">=</span> perf_counter()</a>
<a class="sourceLine" id="cb8-14" title="14">        func()</a>
<a class="sourceLine" id="cb8-15" title="15">        total <span class="op">+=</span> (perf_counter() <span class="op">-</span> start) <span class="op">*</span> <span class="fl">1e6</span></a>
<a class="sourceLine" id="cb8-16" title="16">    <span class="cf">return</span> total <span class="op">/</span> times</a>
<a class="sourceLine" id="cb8-17" title="17"></a>
<a class="sourceLine" id="cb8-18" title="18"><span class="kw">def</span> time_it(sequence):</a>
<a class="sourceLine" id="cb8-19" title="19">    middle <span class="op">=</span> <span class="bu">len</span>(sequence) <span class="op">//</span> <span class="dv">2</span></a>
<a class="sourceLine" id="cb8-20" title="20">    sequence.insert(middle, <span class="st">&quot;middle&quot;</span>)</a>
<a class="sourceLine" id="cb8-21" title="21">    sequence[middle]</a>
<a class="sourceLine" id="cb8-22" title="22">    sequence.remove(<span class="st">&quot;middle&quot;</span>)</a>
<a class="sourceLine" id="cb8-23" title="23">    <span class="kw">del</span> sequence[middle]</a>
<a class="sourceLine" id="cb8-24" title="24"></a>
<a class="sourceLine" id="cb8-25" title="25">list_time <span class="op">=</span> average_time(<span class="kw">lambda</span>: time_it(a_list), TIMES)</a>
<a class="sourceLine" id="cb8-26" title="26">deque_time <span class="op">=</span> average_time(<span class="kw">lambda</span>: time_it(a_deque), TIMES)</a>
<a class="sourceLine" id="cb8-27" title="27">gain <span class="op">=</span> deque_time <span class="op">/</span> list_time</a>
<a class="sourceLine" id="cb8-28" title="28"></a>
<a class="sourceLine" id="cb8-29" title="29"><span class="bu">print</span>(<span class="ss">f&quot;list  </span><span class="sc">{</span>list_time<span class="sc">:.6}</span><span class="ss"> μs (</span><span class="sc">{</span>gain<span class="sc">:.6}</span><span class="ss">x faster)&quot;</span>)</a>
<a class="sourceLine" id="cb8-30" title="30"><span class="bu">print</span>(<span class="ss">f&quot;deque </span><span class="sc">{</span>deque_time<span class="sc">:.6}</span><span class="ss"> μs&quot;</span>)</a></code></pre></div>
<p>This script times inserting, deleting, and accessing items in the middle of a deque and a list. If you run the script, then you get an output that looks like the following:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb9-1" title="1">$ python time_random_access.py</a>
<a class="sourceLine" id="cb9-2" title="2"><span class="bu">list</span>  <span class="fl">63.8658</span> μs (<span class="fl">1.44517</span>x faster)</a>
<a class="sourceLine" id="cb9-3" title="3">deque <span class="fl">92.2968</span> μs</a></code></pre></div>
<p>Deques aren’t random-access data structures like lists. Therefore, accessing elements from the middle of a deque is less efficient than doing the same thing on a list. The main takeaway here is that deques aren’t always more efficient than lists.</p>
<p>Python’s <code>deque</code> is optimized for operations on either end of the sequence, so they’re consistently better than lists in this regard. On the other hand, lists are better for random-access and fixed-length operations. Here are some of the differences between deques and lists in terms of performance:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Operation</th>
<th style="text-align: left;"><code>deque</code></th>
<th style="text-align: left;"><code>list</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Accessing arbitrary items through indexing</td>
<td style="text-align: left;"><em>O</em>(<em>n</em>)</td>
<td style="text-align: left;"><em>O</em>(1)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Popping and appending items on the left end</td>
<td style="text-align: left;"><em>O</em>(1)</td>
<td style="text-align: left;"><em>O</em>(<em>n</em>)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Popping and appending items on the right end</td>
<td style="text-align: left;"><em>O</em>(1)</td>
<td style="text-align: left;"><em>O</em>(1) + reallocation</td>
</tr>
<tr class="even">
<td style="text-align: left;">Inserting and deleting items in the middle</td>
<td style="text-align: left;"><em>O</em>(<em>n</em>)</td>
<td style="text-align: left;"><em>O</em>(<em>n</em>)</td>
</tr>
</tbody>
</table>
<p>In the case of lists, <code>.append()</code> has amortized performance affected by memory reallocation when the interpreter needs to grow the list to accept new items. This operation requires copying all the current items to the new memory location, which significantly affects the performance.</p>
<p>This summary can help you choose the appropriate data type for the problem at hand. However, make sure to profile your code before switching from lists to deques. Both of them have their performance strengths.<a href="https://srv.realpython.net/click/67002144333/?c=56207115366&amp;p=58946116052&amp;r=10842"><img src="https://img.realpython.net/e822f46aa4962c3565f257bb0c4679a8" /></a><a href="https://realpython.com/account/join/">Remove ads</a></p>
<h3 id="building-efficient-queues-with-deque">Building Efficient Queues With <code>deque</code></h3>
<p>As you already learned, <code>deque</code> is implemented as a double-ended queue that provides a generalization of <strong>stacks</strong> and <strong>queues</strong>. In this section, you’ll learn how to use <code>deque</code> for implementing your own queue <a href="https://en.wikipedia.org/wiki/Abstract_data_type">abstract data types (ADT)</a> at a low level in an elegant, efficient, and Pythonic way.</p>
<p><strong>Note:</strong> In the Python standard library, you’ll find <a href="https://docs.python.org/3/library/queue.html#module-queue"><code>queue</code></a>. This module implements multi-producer, multi-consumer queues that allow you to exchange information between multiple threads safely.</p>
<p>If you’re working with queues, then favor using those high-level abstractions over <code>deque</code> unless you’re implementing your own data structure.</p>
<p>Queues are <a href="https://en.wikipedia.org/wiki/Collection_%28abstract_data_type%29">collections</a> of items. You can modify queues by adding items at one end and removing items from the opposite end.</p>
<p>Queues manage their items in a <strong>First-In/First-Out</strong> (<a href="https://en.wikipedia.org/wiki/FIFO_%28computing_and_electronics%29">FIFO</a>) fashion. They work as a pipe where you push in new items at one end of the pipe and pop old items out from the other end. Adding an item to one end of a queue is known as an <strong>enqueue</strong> operation. Removing an item from the other end is called <strong>dequeue</strong>.</p>
<p>To better understand queues, take your favorite restaurant as an example. The restaurant has a queue of people waiting for a table to order their food. Typically, the last person to arrive will stand at the end of the queue. The person at the beginning of the queue will leave it as soon as a table is available.</p>
<p>Here’s how you can emulate the process using a bare-bones <code>deque</code> object:&gt;&gt;&gt;</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb10-1" title="1"><span class="op">&gt;&gt;&gt;</span> <span class="im">from</span> collections <span class="im">import</span> deque</a>
<a class="sourceLine" id="cb10-2" title="2"></a>
<a class="sourceLine" id="cb10-3" title="3"><span class="op">&gt;&gt;&gt;</span> customers <span class="op">=</span> deque()</a>
<a class="sourceLine" id="cb10-4" title="4"></a>
<a class="sourceLine" id="cb10-5" title="5"><span class="op">&gt;&gt;&gt;</span> <span class="co"># People arriving</span></a>
<a class="sourceLine" id="cb10-6" title="6"><span class="op">&gt;&gt;&gt;</span> customers.append(<span class="st">&quot;Jane&quot;</span>)</a>
<a class="sourceLine" id="cb10-7" title="7"><span class="op">&gt;&gt;&gt;</span> customers.append(<span class="st">&quot;John&quot;</span>)</a>
<a class="sourceLine" id="cb10-8" title="8"><span class="op">&gt;&gt;&gt;</span> customers.append(<span class="st">&quot;Linda&quot;</span>)</a>
<a class="sourceLine" id="cb10-9" title="9"></a>
<a class="sourceLine" id="cb10-10" title="10"><span class="op">&gt;&gt;&gt;</span> customers</a>
<a class="sourceLine" id="cb10-11" title="11">deque([<span class="st">&#39;Jane&#39;</span>, <span class="st">&#39;John&#39;</span>, <span class="st">&#39;Linda&#39;</span>])</a>
<a class="sourceLine" id="cb10-12" title="12"></a>
<a class="sourceLine" id="cb10-13" title="13"><span class="op">&gt;&gt;&gt;</span> <span class="co"># People getting tables</span></a>
<a class="sourceLine" id="cb10-14" title="14"><span class="op">&gt;&gt;&gt;</span> customers.popleft()</a>
<a class="sourceLine" id="cb10-15" title="15"><span class="co">&#39;Jane&#39;</span></a>
<a class="sourceLine" id="cb10-16" title="16"><span class="op">&gt;&gt;&gt;</span> customers.popleft()</a>
<a class="sourceLine" id="cb10-17" title="17"><span class="co">&#39;John&#39;</span></a>
<a class="sourceLine" id="cb10-18" title="18"><span class="op">&gt;&gt;&gt;</span> customers.popleft()</a>
<a class="sourceLine" id="cb10-19" title="19"><span class="co">&#39;Linda&#39;</span></a>
<a class="sourceLine" id="cb10-20" title="20"></a>
<a class="sourceLine" id="cb10-21" title="21"><span class="op">&gt;&gt;&gt;</span> <span class="co"># No people in the queue</span></a>
<a class="sourceLine" id="cb10-22" title="22"><span class="op">&gt;&gt;&gt;</span> customers.popleft()</a>
<a class="sourceLine" id="cb10-23" title="23">Traceback (most recent call last):</a>
<a class="sourceLine" id="cb10-24" title="24">  File <span class="st">&quot;&lt;stdin&gt;&quot;</span>, line <span class="dv">1</span>, <span class="kw">in</span> <span class="op">&lt;</span>module<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb10-25" title="25"><span class="pp">IndexError</span>: pop <span class="im">from</span> an empty deque</a></code></pre></div>
<p>Here, you first create an empty <code>deque</code> object to represent the queue of people arriving at the restaurant. To enqueue a person, you use <a href="https://docs.python.org/3/library/collections.html#collections.deque.append"><code>.append()</code></a>, which adds individual items to the right end. To dequeue a person, you use <a href="https://docs.python.org/3/library/collections.html#collections.deque.popleft"><code>.popleft()</code></a>, which removes and returns individual items on the left end of a deque.</p>
<p>Cool! Your queue simulation works! However, since <code>deque</code> is a generalization, its <a href="https://en.wikipedia.org/wiki/API">API</a> doesn’t match the typical queue API. For example, instead of <code>.enqueue()</code>, you have <code>.append()</code>. You also have <code>.popleft()</code> instead of <code>.dequeue()</code>. Additionally, <code>deque</code> provides several other operations that might not fit your specific needs.</p>
<p>The good news is that you can create custom queue classes with the functionality you need and nothing else. To do this, you can internally use a deque to store the data and provide the desired functionality in your custom queues. You can think of it as an implementation of the <a href="https://sourcemaking.com/design_patterns/adapter">adapter design pattern</a>, in which you convert the deque’s interface into something that looks more like a queue interface.</p>
<p>For example, say you need a custom queue abstract data type that provides only the following features:</p>
<ul>
<li>Enqueuing items</li>
<li>Dequeuing items</li>
<li>Returning the length of the queue</li>
<li>Supporting membership tests</li>
<li>Supporting normal and reverse iteration</li>
<li>Providing a user-friendly string representation</li>
</ul>
<p>In this case, you can write a <code>Queue</code> class that looks like the following:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb11-1" title="1"><span class="co"># custom_queue.py</span></a>
<a class="sourceLine" id="cb11-2" title="2"></a>
<a class="sourceLine" id="cb11-3" title="3"><span class="im">from</span> collections <span class="im">import</span> deque</a>
<a class="sourceLine" id="cb11-4" title="4"></a>
<a class="sourceLine" id="cb11-5" title="5"><span class="kw">class</span> Queue:</a>
<a class="sourceLine" id="cb11-6" title="6">    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</a>
<a class="sourceLine" id="cb11-7" title="7">        <span class="va">self</span>._items <span class="op">=</span> deque()</a>
<a class="sourceLine" id="cb11-8" title="8"></a>
<a class="sourceLine" id="cb11-9" title="9">    <span class="kw">def</span> enqueue(<span class="va">self</span>, item):</a>
<a class="sourceLine" id="cb11-10" title="10">        <span class="va">self</span>._items.append(item)</a>
<a class="sourceLine" id="cb11-11" title="11"></a>
<a class="sourceLine" id="cb11-12" title="12">    <span class="kw">def</span> dequeue(<span class="va">self</span>):</a>
<a class="sourceLine" id="cb11-13" title="13">        <span class="cf">try</span>:</a>
<a class="sourceLine" id="cb11-14" title="14">            <span class="cf">return</span> <span class="va">self</span>._items.popleft()</a>
<a class="sourceLine" id="cb11-15" title="15">        <span class="cf">except</span> <span class="pp">IndexError</span>:</a>
<a class="sourceLine" id="cb11-16" title="16">            <span class="cf">raise</span> <span class="pp">IndexError</span>(<span class="st">&quot;dequeue from an empty queue&quot;</span>) <span class="im">from</span> <span class="va">None</span></a>
<a class="sourceLine" id="cb11-17" title="17"></a>
<a class="sourceLine" id="cb11-18" title="18">    <span class="kw">def</span> <span class="fu">__len__</span>(<span class="va">self</span>):</a>
<a class="sourceLine" id="cb11-19" title="19">        <span class="cf">return</span> <span class="bu">len</span>(<span class="va">self</span>._items)</a>
<a class="sourceLine" id="cb11-20" title="20"></a>
<a class="sourceLine" id="cb11-21" title="21">    <span class="kw">def</span> <span class="fu">__contains__</span>(<span class="va">self</span>, item):</a>
<a class="sourceLine" id="cb11-22" title="22">        <span class="cf">return</span> item <span class="kw">in</span> <span class="va">self</span>._items</a>
<a class="sourceLine" id="cb11-23" title="23"></a>
<a class="sourceLine" id="cb11-24" title="24">    <span class="kw">def</span> <span class="fu">__iter__</span>(<span class="va">self</span>):</a>
<a class="sourceLine" id="cb11-25" title="25">        <span class="cf">yield</span> <span class="im">from</span> <span class="va">self</span>._items</a>
<a class="sourceLine" id="cb11-26" title="26"></a>
<a class="sourceLine" id="cb11-27" title="27">    <span class="kw">def</span> <span class="fu">__reversed__</span>(<span class="va">self</span>):</a>
<a class="sourceLine" id="cb11-28" title="28">        <span class="cf">yield</span> <span class="im">from</span> <span class="bu">reversed</span>(<span class="va">self</span>._items)</a>
<a class="sourceLine" id="cb11-29" title="29"></a>
<a class="sourceLine" id="cb11-30" title="30">    <span class="kw">def</span> <span class="fu">__repr__</span>(<span class="va">self</span>):</a>
<a class="sourceLine" id="cb11-31" title="31">        <span class="cf">return</span> <span class="ss">f&quot;Queue(</span><span class="sc">{</span><span class="bu">list</span>(<span class="va">self</span>._items)<span class="sc">}</span><span class="ss">)&quot;</span></a></code></pre></div>
<p>Here, <code>._items</code> holds a <code>deque</code> object that allows you to store and manipulate the items in the queue. <code>Queue</code> implements <code>.enqueue()</code> using <code>deque.append()</code> to add items to the end of the queue. It also implements <code>.dequeue()</code> with <code>deque.popleft()</code> to efficiently remove items from the beginning of the queue.</p>
<p>The <a href="https://docs.python.org/3/glossary.html#term-special-method">special methods</a> support the following features:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Method</th>
<th style="text-align: left;">Support</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><a href="https://docs.python.org/3/reference/datamodel.html#object.__len__"><code>.__len__()</code></a></td>
<td style="text-align: left;">Length with <code>len()</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><a href="https://docs.python.org/3/reference/datamodel.html#object.__contains__"><code>.__contains__()</code></a></td>
<td style="text-align: left;">Membership tests with <code>in</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><a href="https://docs.python.org/3/reference/datamodel.html#object.__iter__"><code>.__iter__()</code></a></td>
<td style="text-align: left;">Normal iteration</td>
</tr>
<tr class="even">
<td style="text-align: left;"><a href="https://docs.python.org/3/reference/datamodel.html#object.__reversed__"><code>.__reversed__()</code></a></td>
<td style="text-align: left;">Reverse iteration</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><a href="https://docs.python.org/3/reference/datamodel.html#object.__repr__"><code>.__repr__()</code></a></td>
<td style="text-align: left;">String representation</td>
</tr>
</tbody>
</table>
<p>Ideally, <code>.__repr__()</code> should return a string representing a valid Python expression. This expression will allow you to recreate the object unambiguously with the same value.</p>
<p>However, in the example above, the intent is to use the method’s <a href="https://realpython.com/python-return-statement/">return</a> value to gracefully display the object on the <a href="https://realpython.com/interacting-with-python/">interactive shell</a>. You can make it possible to build <code>Queue</code> instances from this specific string representation by accepting an initialization iterable as an argument to <code>.__init__()</code> and building instances from it.</p>
<p>With these final additions, your <code>Queue</code> class is complete. To use this class in your code, you can do something like the following:&gt;&gt;&gt;</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb12-1" title="1"><span class="op">&gt;&gt;&gt;</span> <span class="im">from</span> custom_queue <span class="im">import</span> Queue</a>
<a class="sourceLine" id="cb12-2" title="2"></a>
<a class="sourceLine" id="cb12-3" title="3"><span class="op">&gt;&gt;&gt;</span> numbers <span class="op">=</span> Queue()</a>
<a class="sourceLine" id="cb12-4" title="4"><span class="op">&gt;&gt;&gt;</span> numbers</a>
<a class="sourceLine" id="cb12-5" title="5">Queue([])</a>
<a class="sourceLine" id="cb12-6" title="6"></a>
<a class="sourceLine" id="cb12-7" title="7"><span class="op">&gt;&gt;&gt;</span> <span class="co"># Enqueue items</span></a>
<a class="sourceLine" id="cb12-8" title="8"><span class="op">&gt;&gt;&gt;</span> <span class="cf">for</span> number <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">5</span>):</a>
<a class="sourceLine" id="cb12-9" title="9">...     numbers.enqueue(number)</a>
<a class="sourceLine" id="cb12-10" title="10">...</a>
<a class="sourceLine" id="cb12-11" title="11"><span class="op">&gt;&gt;&gt;</span> numbers</a>
<a class="sourceLine" id="cb12-12" title="12">Queue([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>])</a>
<a class="sourceLine" id="cb12-13" title="13"></a>
<a class="sourceLine" id="cb12-14" title="14"><span class="op">&gt;&gt;&gt;</span> <span class="co"># Support len()</span></a>
<a class="sourceLine" id="cb12-15" title="15"><span class="op">&gt;&gt;&gt;</span> <span class="bu">len</span>(numbers)</a>
<a class="sourceLine" id="cb12-16" title="16"><span class="dv">4</span></a>
<a class="sourceLine" id="cb12-17" title="17"></a>
<a class="sourceLine" id="cb12-18" title="18"><span class="op">&gt;&gt;&gt;</span> <span class="co"># Support membership tests</span></a>
<a class="sourceLine" id="cb12-19" title="19"><span class="op">&gt;&gt;&gt;</span> <span class="dv">2</span> <span class="kw">in</span> numbers</a>
<a class="sourceLine" id="cb12-20" title="20"><span class="va">True</span></a>
<a class="sourceLine" id="cb12-21" title="21"><span class="op">&gt;&gt;&gt;</span> <span class="dv">10</span> <span class="kw">in</span> numbers</a>
<a class="sourceLine" id="cb12-22" title="22"><span class="va">False</span></a>
<a class="sourceLine" id="cb12-23" title="23"></a>
<a class="sourceLine" id="cb12-24" title="24"><span class="op">&gt;&gt;&gt;</span> <span class="co"># Normal iteration</span></a>
<a class="sourceLine" id="cb12-25" title="25"><span class="op">&gt;&gt;&gt;</span> <span class="cf">for</span> number <span class="kw">in</span> numbers:</a>
<a class="sourceLine" id="cb12-26" title="26">...     <span class="bu">print</span>(<span class="ss">f&quot;Number: </span><span class="sc">{</span>number<span class="sc">}</span><span class="ss">&quot;</span>)</a>
<a class="sourceLine" id="cb12-27" title="27">...</a>
<a class="sourceLine" id="cb12-28" title="28"><span class="dv">1</span></a>
<a class="sourceLine" id="cb12-29" title="29"><span class="dv">2</span></a>
<a class="sourceLine" id="cb12-30" title="30"><span class="dv">3</span></a>
<a class="sourceLine" id="cb12-31" title="31"><span class="dv">4</span></a></code></pre></div>
<p>As an exercise, you can test the remaining features and implement other features, such as supporting equality tests, removing and accessing random items, and more. Go ahead and give it a try<img src="https://srv.realpython.net/click/51173158879/?c=3190889540&amp;p=58946116052&amp;r=98172" alt="" /><a href="https://realpython.com/account/join/">Remove ads</a></p>
<h3 id="exploring-other-features-of-deque">Exploring Other Features of <code>deque</code></h3>
<p>In addition to the features you’ve seen so far, <code>deque</code> also provides other methods and attributes specific to their internal design. They add new and useful functionalities to this versatile data type.</p>
<p>In this section, you’ll learn about other methods and attributes that deques provide, how they work, and how to use them in your code.</p>
<h4 id="limiting-the-maximum-number-of-items-maxlen">Limiting the Maximum Number of Items: <code>maxlen</code></h4>
<p>One of the most useful features of <code>deque</code> is the possibility to specify the <strong>maximum length</strong> of a given deque using the <code>maxlen</code> argument when you’re instantiating the class.</p>
<p>If you supply a value to <code>maxlen</code>, then your deque will only store up to <code>maxlen</code> items. In this case, you have a <strong>bounded deque</strong>. Once a bounded deque is full with the specified number of items, adding a new item at either end automatically removes and discards the item at the opposite end:&gt;&gt;&gt;</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb13-1" title="1"><span class="op">&gt;&gt;&gt;</span> <span class="im">from</span> collections <span class="im">import</span> deque</a>
<a class="sourceLine" id="cb13-2" title="2"></a>
<a class="sourceLine" id="cb13-3" title="3"><span class="op">&gt;&gt;&gt;</span> four_numbers <span class="op">=</span> deque([<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>], maxlen<span class="op">=</span><span class="dv">4</span>) <span class="co"># Discard 0</span></a>
<a class="sourceLine" id="cb13-4" title="4"><span class="op">&gt;&gt;&gt;</span> four_numbers</a>
<a class="sourceLine" id="cb13-5" title="5">deque([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>], maxlen<span class="op">=</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb13-6" title="6"></a>
<a class="sourceLine" id="cb13-7" title="7"><span class="op">&gt;&gt;&gt;</span> four_numbers.append(<span class="dv">5</span>)  <span class="co"># Automatically remove 1</span></a>
<a class="sourceLine" id="cb13-8" title="8"><span class="op">&gt;&gt;&gt;</span> four_numbers</a>
<a class="sourceLine" id="cb13-9" title="9">deque([<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>], maxlen<span class="op">=</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb13-10" title="10"></a>
<a class="sourceLine" id="cb13-11" title="11"><span class="op">&gt;&gt;&gt;</span> four_numbers.append(<span class="dv">6</span>)  <span class="co"># Automatically remove 2</span></a>
<a class="sourceLine" id="cb13-12" title="12"><span class="op">&gt;&gt;&gt;</span> four_numbers</a>
<a class="sourceLine" id="cb13-13" title="13">deque([<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>], maxlen<span class="op">=</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb13-14" title="14"></a>
<a class="sourceLine" id="cb13-15" title="15"><span class="op">&gt;&gt;&gt;</span> four_numbers.appendleft(<span class="dv">2</span>) <span class="co"># Automatically remove 6</span></a>
<a class="sourceLine" id="cb13-16" title="16"><span class="op">&gt;&gt;&gt;</span> four_numbers</a>
<a class="sourceLine" id="cb13-17" title="17">deque([<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>], maxlen<span class="op">=</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb13-18" title="18"></a>
<a class="sourceLine" id="cb13-19" title="19"><span class="op">&gt;&gt;&gt;</span> four_numbers.appendleft(<span class="dv">1</span>)  <span class="co"># Automatically remove 5</span></a>
<a class="sourceLine" id="cb13-20" title="20"><span class="op">&gt;&gt;&gt;</span> four_numbers</a>
<a class="sourceLine" id="cb13-21" title="21">deque([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>], maxlen<span class="op">=</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb13-22" title="22"></a>
<a class="sourceLine" id="cb13-23" title="23"><span class="op">&gt;&gt;&gt;</span> four_numbers.maxlen</a>
<a class="sourceLine" id="cb13-24" title="24"><span class="dv">4</span></a></code></pre></div>
<p>If the number of items in the input iterable is greater than <code>maxlen</code>, then <code>deque</code> discards the left-most items (<code>0</code> in the example). Once the deque is full, appending an item on any end automatically removes the item on the other end.</p>
<p>Note that if you don’t specify a value to <code>maxlen</code>, then it defaults to <a href="https://realpython.com/null-in-python/"><code>None</code></a>, and the deque can grow to an arbitrary number of items.</p>
<p>Having the option to restrict the maximum number of items allows you to use deques for tracking the latest elements in a given sequence of objects or events. For example, you can track the last five transactions in a bank account, the last ten open text files in an editor, the last five pages in a browser, and more.</p>
<p>Note that <code>maxlen</code> is available as a read-only attribute in your deques, which allows you to check if the deque is full, like in <code>deque.maxlen == len(deque)</code>.</p>
<p>Finally, you can set <code>maxlen</code> to any positive integer number representing the maximum number of items you want to store in a specific deque. If you supply a negative value to <code>maxlen</code>, then you get a <code>ValueError</code>.</p>
<h4 id="rotating-the-items-.rotate">Rotating the Items: <code>.rotate()</code></h4>
<p>Another interesting feature of deques is the possibility to rotate their elements by calling <a href="https://docs.python.org/3/library/collections.html#collections.deque.rotate"><code>.rotate()</code></a> on a non-empty deque. This method takes an integer <code>n</code> as an argument and rotates the items <code>n</code> steps to the right. In other words, it moves <code>n</code> items from the right end to the left end in a circular fashion.</p>
<p>The default value of <code>n</code> is <code>1</code>. If you provide a negative value to <code>n</code>, then the rotation is to the left:&gt;&gt;&gt;</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb14-1" title="1"><span class="op">&gt;&gt;&gt;</span> <span class="im">from</span> collections <span class="im">import</span> deque</a>
<a class="sourceLine" id="cb14-2" title="2"></a>
<a class="sourceLine" id="cb14-3" title="3"><span class="op">&gt;&gt;&gt;</span> ordinals <span class="op">=</span> deque([<span class="st">&quot;first&quot;</span>, <span class="st">&quot;second&quot;</span>, <span class="st">&quot;third&quot;</span>])</a>
<a class="sourceLine" id="cb14-4" title="4"></a>
<a class="sourceLine" id="cb14-5" title="5"><span class="op">&gt;&gt;&gt;</span> <span class="co"># Rotate items to the right</span></a>
<a class="sourceLine" id="cb14-6" title="6"><span class="op">&gt;&gt;&gt;</span> ordinals.rotate()</a>
<a class="sourceLine" id="cb14-7" title="7"><span class="op">&gt;&gt;&gt;</span> ordinals</a>
<a class="sourceLine" id="cb14-8" title="8">deque([<span class="st">&#39;third&#39;</span>, <span class="st">&#39;first&#39;</span>, <span class="st">&#39;second&#39;</span>])</a>
<a class="sourceLine" id="cb14-9" title="9"></a>
<a class="sourceLine" id="cb14-10" title="10"><span class="op">&gt;&gt;&gt;</span> ordinals.rotate(<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb14-11" title="11"><span class="op">&gt;&gt;&gt;</span> ordinals</a>
<a class="sourceLine" id="cb14-12" title="12">deque([<span class="st">&#39;first&#39;</span>, <span class="st">&#39;second&#39;</span>, <span class="st">&#39;third&#39;</span>])</a>
<a class="sourceLine" id="cb14-13" title="13"></a>
<a class="sourceLine" id="cb14-14" title="14"><span class="op">&gt;&gt;&gt;</span> <span class="co"># Rotate items to the left</span></a>
<a class="sourceLine" id="cb14-15" title="15"><span class="op">&gt;&gt;&gt;</span> ordinals.rotate(<span class="op">-</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb14-16" title="16"><span class="op">&gt;&gt;&gt;</span> ordinals</a>
<a class="sourceLine" id="cb14-17" title="17">deque([<span class="st">&#39;third&#39;</span>, <span class="st">&#39;first&#39;</span>, <span class="st">&#39;second&#39;</span>])</a>
<a class="sourceLine" id="cb14-18" title="18"></a>
<a class="sourceLine" id="cb14-19" title="19"><span class="op">&gt;&gt;&gt;</span> ordinals.rotate(<span class="op">-</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb14-20" title="20"><span class="op">&gt;&gt;&gt;</span> ordinals</a>
<a class="sourceLine" id="cb14-21" title="21">deque([<span class="st">&#39;first&#39;</span>, <span class="st">&#39;second&#39;</span>, <span class="st">&#39;third&#39;</span>])</a></code></pre></div>
<p>In these examples, you rotate <code>ordinals</code> several times using <code>.rotate()</code> with different values of <code>n</code>. If you call <code>.rotate()</code> without an argument, then it relies on the default value of <code>n</code> and rotates the deque <code>1</code> position to the right. Calling the method with a negative <code>n</code> allows you to rotate the items to the left.</p>
<h4 id="adding-several-items-at-once-.extendleft">Adding Several Items at Once: <code>.extendleft()</code></h4>
<p>Like regular lists, deques provide an <a href="https://docs.python.org/3/library/collections.html#collections.deque.extend"><code>.extend()</code></a> method, which allows you to add several items to the right end of a deque using an <code>iterable</code> as an argument. Additionally, deques have a method called <a href="https://docs.python.org/3/library/collections.html#collections.deque.extendleft"><code>extendleft()</code></a>, which takes an <code>iterable</code> as an argument and adds its items to the left end of the target deque in one go:&gt;&gt;&gt;</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb15-1" title="1"><span class="op">&gt;&gt;&gt;</span> <span class="im">from</span> collections <span class="im">import</span> deque</a>
<a class="sourceLine" id="cb15-2" title="2"></a>
<a class="sourceLine" id="cb15-3" title="3"><span class="op">&gt;&gt;&gt;</span> numbers <span class="op">=</span> deque([<span class="dv">1</span>, <span class="dv">2</span>])</a>
<a class="sourceLine" id="cb15-4" title="4"></a>
<a class="sourceLine" id="cb15-5" title="5"><span class="op">&gt;&gt;&gt;</span> <span class="co"># Extend to the right</span></a>
<a class="sourceLine" id="cb15-6" title="6"><span class="op">&gt;&gt;&gt;</span> numbers.extend([<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>])</a>
<a class="sourceLine" id="cb15-7" title="7"><span class="op">&gt;&gt;&gt;</span> numbers</a>
<a class="sourceLine" id="cb15-8" title="8">deque([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>])</a>
<a class="sourceLine" id="cb15-9" title="9"></a>
<a class="sourceLine" id="cb15-10" title="10"><span class="op">&gt;&gt;&gt;</span> <span class="co"># Extend to the left</span></a>
<a class="sourceLine" id="cb15-11" title="11"><span class="op">&gt;&gt;&gt;</span> numbers.extendleft([<span class="op">-</span><span class="dv">1</span>, <span class="dv">-2</span>, <span class="dv">-3</span>, <span class="dv">-4</span>, <span class="dv">-5</span>])</a>
<a class="sourceLine" id="cb15-12" title="12"><span class="op">&gt;&gt;&gt;</span> numbers</a>
<a class="sourceLine" id="cb15-13" title="13">deque([<span class="op">-</span><span class="dv">5</span>, <span class="dv">-4</span>, <span class="dv">-3</span>, <span class="dv">-2</span>, <span class="dv">-1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>])</a></code></pre></div>
<p>Calling <code>.extendleft()</code> with an <code>iterable</code> extends the target deque to the left. Internally, <code>.extendleft()</code> performs a series of individual <code>.appendleft()</code> operations that process the input iterable from left to right. This ends up adding the items in reverse order to the left end of the target deque.<a href="https://srv.realpython.net/click/53616533979/?c=62098619220&amp;p=58946116052&amp;r=67323"><img src="https://img.realpython.net/babd32c4a9b6cf2453889710f58b5914" /></a><a href="https://realpython.com/account/join/">Remove ads</a></p>
<h3 id="using-sequence-like-features-of-deque">Using Sequence-Like Features of <code>deque</code></h3>
<p>Since deques are mutable sequences, they implement almost all the methods and operations that are common to <a href="https://docs.python.org/3/library/stdtypes.html?highlight=built#common-sequence-operations">sequences</a> and <a href="https://docs.python.org/3/library/stdtypes.html#mutable-sequence-types">mutable sequences</a>. So far, you’ve learned about some of these methods and operations, such as <code>.insert()</code>, indexing, membership tests, and more.</p>
<p>Here are a few examples of other actions you can perform on <code>deque</code> objects:&gt;&gt;&gt;</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb16-1" title="1"><span class="op">&gt;&gt;&gt;</span> <span class="im">from</span> collections <span class="im">import</span> deque</a>
<a class="sourceLine" id="cb16-2" title="2"></a>
<a class="sourceLine" id="cb16-3" title="3"><span class="op">&gt;&gt;&gt;</span> numbers <span class="op">=</span> deque([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">5</span>])</a>
<a class="sourceLine" id="cb16-4" title="4"></a>
<a class="sourceLine" id="cb16-5" title="5"><span class="op">&gt;&gt;&gt;</span> <span class="co"># Concatenation</span></a>
<a class="sourceLine" id="cb16-6" title="6"><span class="op">&gt;&gt;&gt;</span> numbers <span class="op">+</span> deque([<span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>])</a>
<a class="sourceLine" id="cb16-7" title="7">deque([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>])</a>
<a class="sourceLine" id="cb16-8" title="8"></a>
<a class="sourceLine" id="cb16-9" title="9"><span class="op">&gt;&gt;&gt;</span> <span class="co"># Repetition</span></a>
<a class="sourceLine" id="cb16-10" title="10"><span class="op">&gt;&gt;&gt;</span> numbers <span class="op">*</span> <span class="dv">2</span></a>
<a class="sourceLine" id="cb16-11" title="11">deque([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">5</span>])</a>
<a class="sourceLine" id="cb16-12" title="12"></a>
<a class="sourceLine" id="cb16-13" title="13"><span class="op">&gt;&gt;&gt;</span> <span class="co"># Common sequence methods</span></a>
<a class="sourceLine" id="cb16-14" title="14"><span class="op">&gt;&gt;&gt;</span> numbers <span class="op">=</span> deque([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">5</span>])</a>
<a class="sourceLine" id="cb16-15" title="15"><span class="op">&gt;&gt;&gt;</span> numbers.index(<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb16-16" title="16"><span class="dv">1</span></a>
<a class="sourceLine" id="cb16-17" title="17"><span class="op">&gt;&gt;&gt;</span> numbers.count(<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb16-18" title="18"><span class="dv">2</span></a>
<a class="sourceLine" id="cb16-19" title="19"></a>
<a class="sourceLine" id="cb16-20" title="20"><span class="op">&gt;&gt;&gt;</span> <span class="co"># Common mutable sequence methods</span></a>
<a class="sourceLine" id="cb16-21" title="21"><span class="op">&gt;&gt;&gt;</span> numbers.reverse()</a>
<a class="sourceLine" id="cb16-22" title="22"><span class="op">&gt;&gt;&gt;</span> numbers</a>
<a class="sourceLine" id="cb16-23" title="23">deque([<span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>])</a>
<a class="sourceLine" id="cb16-24" title="24"></a>
<a class="sourceLine" id="cb16-25" title="25"><span class="op">&gt;&gt;&gt;</span> numbers.clear()</a>
<a class="sourceLine" id="cb16-26" title="26"><span class="op">&gt;&gt;&gt;</span> numbers</a>
<a class="sourceLine" id="cb16-27" title="27">deque([])</a></code></pre></div>
<p>You can use the addition <a href="https://realpython.com/python-operators-expressions/">operator</a> (<code>+</code>) to concatenate two existing deques. On the other hand, the multiplication operator (<code>*</code>) returns a new deque equivalent to repeating the original deque as many times as you want.</p>
<p>Regarding other sequence methods, the following table provides a summary:</p>
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Method</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><a href="https://docs.python.org/3/library/collections.html#collections.deque.clear"><code>.clear()</code></a></td>
<td style="text-align: left;">Remove all the elements from a deque.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><a href="https://docs.python.org/3/library/collections.html#collections.deque.copy"><code>.copy()</code></a></td>
<td style="text-align: left;">Create a shallow copy of a deque.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><a href="https://docs.python.org/3/library/collections.html#collections.deque.count"><code>.count(value)</code></a></td>
<td style="text-align: left;">Count the number times <code>value</code> appears in a deque.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><a href="https://docs.python.org/3/library/collections.html#collections.deque.index"><code>.index(value)</code></a></td>
<td style="text-align: left;">Return the position of <code>value</code> in the deque.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><a href="https://docs.python.org/3/library/collections.html#collections.deque.reverse"><code>.reverse()</code></a></td>
<td style="text-align: left;">Reverse the elements of the deque in place and then return <code>None</code>.</td>
</tr>
</tbody>
</table>
<p>Here, <code>.index()</code> can also take two optional arguments: <code>start</code> and <code>stop</code>. They allow you to restrict the search to those items at or after <code>start</code> and before <code>stop</code>. The method raises a <a href="https://docs.python.org/3/library/exceptions.html#ValueError"><code>ValueError</code></a> if <code>value</code> doesn’t appear in the deque at hand.</p>
<p>Unlike lists, deques don’t include a <code>.sort()</code> method to sort the sequence in place. This is because sorting a linked list would be an inefficient operation. If you ever need to sort a deque, then you can still use <code>sorted()</code>.</p>
<h3 id="putting-pythons-deque-into-action">Putting Python’s <code>deque</code> Into Action</h3>
<p>You can use deques in a fair amount of use cases, such as to implement queues, stacks, and <a href="https://en.wikipedia.org/wiki/Circular_buffer">circular buffers</a>. You can also use them to maintain an undo-redo history, enqueue incoming requests to a <a href="https://en.wikipedia.org/wiki/Web_service">web service</a>, keep a list of recently open files and websites, safely exchange data between multiple threads, and more.</p>
<p>In the following sections, you’ll code a few small examples that will help you better understand how to use deques in your code.</p>
<h4 id="keeping-a-page-history">Keeping a Page History</h4>
<p>Having a <code>maxlen</code> to restrict the maximum number of items makes <code>deque</code> suitable for solving several problems. For example, say you’re building an application that <a href="https://realpython.com/python-web-scraping-practical-introduction/">scrapes</a> data from search engines and social media sites. At some point, you need to keep track of the three last sites your application requested data from.</p>
<p>To solve this problem, you can use a deque with a <code>maxlen</code> of <code>3</code>:&gt;&gt;&gt;</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb17-1" title="1"><span class="op">&gt;&gt;&gt;</span> <span class="im">from</span> collections <span class="im">import</span> deque</a>
<a class="sourceLine" id="cb17-2" title="2"></a>
<a class="sourceLine" id="cb17-3" title="3"><span class="op">&gt;&gt;&gt;</span> sites <span class="op">=</span> (</a>
<a class="sourceLine" id="cb17-4" title="4">...     <span class="st">&quot;google.com&quot;</span>,</a>
<a class="sourceLine" id="cb17-5" title="5">...     <span class="st">&quot;yahoo.com&quot;</span>,</a>
<a class="sourceLine" id="cb17-6" title="6">...     <span class="st">&quot;bing.com&quot;</span></a>
<a class="sourceLine" id="cb17-7" title="7">... )</a>
<a class="sourceLine" id="cb17-8" title="8"></a>
<a class="sourceLine" id="cb17-9" title="9"><span class="op">&gt;&gt;&gt;</span> pages <span class="op">=</span> deque(maxlen<span class="op">=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb17-10" title="10"><span class="op">&gt;&gt;&gt;</span> pages.maxlen</a>
<a class="sourceLine" id="cb17-11" title="11"><span class="dv">3</span></a>
<a class="sourceLine" id="cb17-12" title="12"></a>
<a class="sourceLine" id="cb17-13" title="13"><span class="op">&gt;&gt;&gt;</span> <span class="cf">for</span> site <span class="kw">in</span> sites:</a>
<a class="sourceLine" id="cb17-14" title="14">...     pages.appendleft(site)</a>
<a class="sourceLine" id="cb17-15" title="15">...</a>
<a class="sourceLine" id="cb17-16" title="16"></a>
<a class="sourceLine" id="cb17-17" title="17"><span class="op">&gt;&gt;&gt;</span> pages</a>
<a class="sourceLine" id="cb17-18" title="18">deque([<span class="st">&#39;bing.com&#39;</span>, <span class="st">&#39;yahoo.com&#39;</span>, <span class="st">&#39;google.com&#39;</span>], maxlen<span class="op">=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb17-19" title="19"></a>
<a class="sourceLine" id="cb17-20" title="20"><span class="op">&gt;&gt;&gt;</span> pages.appendleft(<span class="st">&quot;facebook.com&quot;</span>)</a>
<a class="sourceLine" id="cb17-21" title="21"><span class="op">&gt;&gt;&gt;</span> pages</a>
<a class="sourceLine" id="cb17-22" title="22">deque([<span class="st">&#39;facebook.com&#39;</span>, <span class="st">&#39;bing.com&#39;</span>, <span class="st">&#39;yahoo.com&#39;</span>], maxlen<span class="op">=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb17-23" title="23"></a>
<a class="sourceLine" id="cb17-24" title="24"><span class="op">&gt;&gt;&gt;</span> pages.appendleft(<span class="st">&quot;twitter.com&quot;</span>)</a>
<a class="sourceLine" id="cb17-25" title="25"><span class="op">&gt;&gt;&gt;</span> pages</a>
<a class="sourceLine" id="cb17-26" title="26">deque([<span class="st">&#39;twitter.com&#39;</span>, <span class="st">&#39;facebook.com&#39;</span>, <span class="st">&#39;bing.com&#39;</span>], maxlen<span class="op">=</span><span class="dv">3</span>)</a></code></pre></div>
<p>In this example, <code>pages</code> keeps a list of the last three sites your application visited. Once <code>pages</code> is full, adding a new site to an end of the deque automatically discards the site at the opposite end. This behavior keeps your list up to date with the last three sites you used.</p>
<p>Note that you can set <code>maxlen</code> to any positive integer representing the number of items to store in the deque at hand. For example, if you want to keep a list of ten sites, then you can set <code>maxlen</code> to <code>10</code>.</p>
<h4 id="sharing-data-between-threads">Sharing Data Between Threads</h4>
<p>Python’s <code>deque</code> is also useful when you’re coding <a href="https://realpython.com/intro-to-python-threading/">multithreaded</a> applications, as described by <a href="https://twitter.com/raymondh">Raymond Hettinger</a>, core Python developer and creator of <code>deque</code> and the <code>collections</code> module:</p>
<blockquote>
<p>The deque’s <code>.append()</code>, <code>.appendleft()</code>, <code>.pop()</code>, <code>.popleft()</code>, and <code>len(d)</code> operations are thread-safe in CPython. (<a href="https://bugs.python.org/msg199368">Source</a>)</p>
</blockquote>
<p>Because of that, you can safely add and remove data from both ends of a deque at the same time from separate threads without the risk of data corruption or other associated issues.</p>
<p>To try out how <code>deque</code> works in a multithreaded application, fire up your favorite <a href="https://realpython.com/python-ides-code-editors-guide/">code editor</a>, create a new script called <code>threads.py</code>, and add the following code to it:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb18-1" title="1"><span class="co"># threads.py</span></a>
<a class="sourceLine" id="cb18-2" title="2"></a>
<a class="sourceLine" id="cb18-3" title="3"><span class="im">import</span> logging</a>
<a class="sourceLine" id="cb18-4" title="4"><span class="im">import</span> random</a>
<a class="sourceLine" id="cb18-5" title="5"><span class="im">import</span> threading</a>
<a class="sourceLine" id="cb18-6" title="6"><span class="im">import</span> time</a>
<a class="sourceLine" id="cb18-7" title="7"><span class="im">from</span> collections <span class="im">import</span> deque</a>
<a class="sourceLine" id="cb18-8" title="8"></a>
<a class="sourceLine" id="cb18-9" title="9">logging.basicConfig(level<span class="op">=</span>logging.INFO, <span class="bu">format</span><span class="op">=</span><span class="st">&quot;</span><span class="sc">%(message)s</span><span class="st">&quot;</span>)</a>
<a class="sourceLine" id="cb18-10" title="10"></a>
<a class="sourceLine" id="cb18-11" title="11"><span class="kw">def</span> wait_seconds(mins, maxs):</a>
<a class="sourceLine" id="cb18-12" title="12">    time.sleep(mins <span class="op">+</span> random.random() <span class="op">*</span> (maxs <span class="op">-</span> mins))</a>
<a class="sourceLine" id="cb18-13" title="13"></a>
<a class="sourceLine" id="cb18-14" title="14"><span class="kw">def</span> produce(queue, size):</a>
<a class="sourceLine" id="cb18-15" title="15">    <span class="cf">while</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb18-16" title="16">        <span class="cf">if</span> <span class="bu">len</span>(queue) <span class="op">&lt;</span> size:</a>
<a class="sourceLine" id="cb18-17" title="17">            value <span class="op">=</span> random.randint(<span class="dv">0</span>, <span class="dv">9</span>)</a>
<a class="sourceLine" id="cb18-18" title="18">            queue.append(value)</a>
<a class="sourceLine" id="cb18-19" title="19">            logging.info(<span class="st">&quot;Produced: </span><span class="sc">%d</span><span class="st"> -&gt; </span><span class="sc">%s</span><span class="st">&quot;</span>, value, <span class="bu">str</span>(queue))</a>
<a class="sourceLine" id="cb18-20" title="20">        <span class="cf">else</span>:</a>
<a class="sourceLine" id="cb18-21" title="21">            logging.info(<span class="st">&quot;Queue is saturated&quot;</span>)</a>
<a class="sourceLine" id="cb18-22" title="22">        wait_seconds(<span class="fl">0.1</span>, <span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb18-23" title="23"></a>
<a class="sourceLine" id="cb18-24" title="24"><span class="kw">def</span> consume(queue):</a>
<a class="sourceLine" id="cb18-25" title="25">    <span class="cf">while</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb18-26" title="26">        <span class="cf">try</span>:</a>
<a class="sourceLine" id="cb18-27" title="27">            value <span class="op">=</span> queue.popleft()</a>
<a class="sourceLine" id="cb18-28" title="28">        <span class="cf">except</span> <span class="pp">IndexError</span>:</a>
<a class="sourceLine" id="cb18-29" title="29">            logging.info(<span class="st">&quot;Queue is empty&quot;</span>)</a>
<a class="sourceLine" id="cb18-30" title="30">        <span class="cf">else</span>:</a>
<a class="sourceLine" id="cb18-31" title="31">            logging.info(<span class="st">&quot;Consumed: </span><span class="sc">%d</span><span class="st"> -&gt; </span><span class="sc">%s</span><span class="st">&quot;</span>, value, <span class="bu">str</span>(queue))</a>
<a class="sourceLine" id="cb18-32" title="32">        wait_seconds(<span class="fl">0.2</span>, <span class="fl">0.7</span>)</a>
<a class="sourceLine" id="cb18-33" title="33"></a>
<a class="sourceLine" id="cb18-34" title="34">logging.info(<span class="st">&quot;Starting Threads...</span><span class="ch">\n</span><span class="st">&quot;</span>)</a>
<a class="sourceLine" id="cb18-35" title="35">logging.info(<span class="st">&quot;Press Ctrl+C to interrupt the execution</span><span class="ch">\n</span><span class="st">&quot;</span>)</a>
<a class="sourceLine" id="cb18-36" title="36"></a>
<a class="sourceLine" id="cb18-37" title="37">shared_queue <span class="op">=</span> deque()</a>
<a class="sourceLine" id="cb18-38" title="38"></a>
<a class="sourceLine" id="cb18-39" title="39">threading.Thread(target<span class="op">=</span>produce, args<span class="op">=</span>(shared_queue, <span class="dv">10</span>)).start()</a>
<a class="sourceLine" id="cb18-40" title="40">threading.Thread(target<span class="op">=</span>consume, args<span class="op">=</span>(shared_queue,)).start()</a></code></pre></div>
<p>Here, <code>produce()</code> takes a <code>queue</code> and a <code>size</code> as arguments. Then it uses <a href="https://docs.python.org/3/library/random.html#random.randint"><code>random.randint()</code></a> in a <a href="https://realpython.com/python-while-loop/"><code>while</code> loop</a> to continuously produce <a href="https://realpython.com/python-random/">random</a> numbers and store them in a <a href="https://realpython.com/python-scope-legb-rule/#modules-the-global-scope">global</a> deque called <code>shared_queue</code>. Since appending items to a deque is a thread-safe operation, you don’t need to use a <a href="https://en.wikipedia.org/wiki/Lock_%28computer_science%29">lock</a> to protect the shared data from other threads.</p>
<p>The helper function <code>wait_seconds()</code> simulates that both <code>produce()</code> and <code>consume()</code> represent long-running operations. It returns a random wait-time value between a given range of seconds, <code>mins</code> and <code>maxs</code>.</p>
<p>In <code>consume()</code>, you call <code>.popleft()</code> inside a loop to systematically retrieve and remove data from <code>shared_queue</code>. You wrap the call to <code>.popleft()</code> in a <a href="https://realpython.com/python-exceptions/#the-try-and-except-block-handling-exceptions"><code>try</code> … <code>except</code></a> statement to handle those cases in which the shared queue is empty.</p>
<p>Note that while you defined <code>shared_queue</code> in the global <a href="https://realpython.com/python-namespaces-scope/">namespace</a>, you access it through local variables inside <code>produce()</code> and <code>consume()</code>. Accessing the global variable directly would be more problematic and definitely not a best practice.</p>
<p>The final two lines in the script create and start separate threads to execute <code>produce()</code> and <code>consume()</code> concurrently. If you run the script from your command line, then you’ll get an output similar to the following:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb19-1" title="1">$ python threads.py</a>
<a class="sourceLine" id="cb19-2" title="2">Starting Threads...</a>
<a class="sourceLine" id="cb19-3" title="3"></a>
<a class="sourceLine" id="cb19-4" title="4">Press Ctrl<span class="op">+</span>C to interrupt the execution</a>
<a class="sourceLine" id="cb19-5" title="5"></a>
<a class="sourceLine" id="cb19-6" title="6">Produced: <span class="dv">1</span> <span class="op">-&gt;</span> deque([<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb19-7" title="7">Consumed: <span class="dv">1</span> <span class="op">-&gt;</span> deque([])</a>
<a class="sourceLine" id="cb19-8" title="8">Queue <span class="kw">is</span> empty</a>
<a class="sourceLine" id="cb19-9" title="9">Produced: <span class="dv">3</span> <span class="op">-&gt;</span> deque([<span class="dv">3</span>])</a>
<a class="sourceLine" id="cb19-10" title="10">Produced: <span class="dv">0</span> <span class="op">-&gt;</span> deque([<span class="dv">3</span>, <span class="dv">0</span>])</a>
<a class="sourceLine" id="cb19-11" title="11">Consumed: <span class="dv">3</span> <span class="op">-&gt;</span> deque([<span class="dv">0</span>])</a>
<a class="sourceLine" id="cb19-12" title="12">Consumed: <span class="dv">0</span> <span class="op">-&gt;</span> deque([])</a>
<a class="sourceLine" id="cb19-13" title="13">Produced: <span class="dv">1</span> <span class="op">-&gt;</span> deque([<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb19-14" title="14">Produced: <span class="dv">0</span> <span class="op">-&gt;</span> deque([<span class="dv">1</span>, <span class="dv">0</span>])</a>
<a class="sourceLine" id="cb19-15" title="15">  ...</a></code></pre></div>
<p>The producer thread adds numbers to the right end of the shared deque, while the consumer thread consumes numbers from the left end. To interrupt the script execution, you can press Ctrl+C on your keyboard.</p>
<p>Finally, you can play a little bit with the time interval inside <code>produce()</code> and <code>consume()</code>. Change the values you pass to <code>wait_seconds()</code>, and watch how the program behaves when the producer is slower than the consumer and the other way around.<a href="https://srv.realpython.net/click/66325228902/?c=62098619220&amp;p=58946116052&amp;r=89098"><img src="https://img.realpython.net/cc86980015e727765da60f4377ac2185" /></a><a href="https://realpython.com/account/join/">Remove ads</a></p>
<h4 id="emulating-the-tail-command">Emulating the <code>tail</code> Command</h4>
<p>The final example you’ll code here emulates the <a href="https://en.wikipedia.org/wiki/Tail_%28Unix%29"><code>tail</code> command</a>, which is available on <a href="https://en.wikipedia.org/wiki/Unix">Unix</a> and <a href="https://en.wikipedia.org/wiki/Unix-like">Unix-like</a> operating systems. The command accepts a file path at the command line and prints the last ten lines of that file to the system’s standard output. You can tweak the number of lines you need <code>tail</code> to print with the <code>-n</code>, <code>--lines</code> option.</p>
<p>Here’s a small Python function that emulates the core functionality of <code>tail</code>:&gt;&gt;&gt;</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb20-1" title="1"><span class="op">&gt;&gt;&gt;</span> <span class="im">from</span> collections <span class="im">import</span> deque</a>
<a class="sourceLine" id="cb20-2" title="2"></a>
<a class="sourceLine" id="cb20-3" title="3"><span class="op">&gt;&gt;&gt;</span> <span class="kw">def</span> tail(filename, lines<span class="op">=</span><span class="dv">10</span>):</a>
<a class="sourceLine" id="cb20-4" title="4">...     <span class="cf">try</span>:</a>
<a class="sourceLine" id="cb20-5" title="5">...         <span class="cf">with</span> <span class="bu">open</span>(filename) <span class="im">as</span> <span class="bu">file</span>:</a>
<a class="sourceLine" id="cb20-6" title="6">...             <span class="cf">return</span> deque(<span class="bu">file</span>, lines)</a>
<a class="sourceLine" id="cb20-7" title="7">...     <span class="cf">except</span> <span class="pp">OSError</span> <span class="im">as</span> error:</a>
<a class="sourceLine" id="cb20-8" title="8">...         <span class="bu">print</span>(<span class="ss">f&#39;Opening file &quot;</span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">&quot; failed with error: </span><span class="sc">{</span>error<span class="sc">}</span><span class="ss">&#39;</span>)</a>
<a class="sourceLine" id="cb20-9" title="9">...</a></code></pre></div>
<p>Here, you define <code>tail()</code>. The first argument, <code>filename</code>, holds the path to the target file as a <a href="https://realpython.com/python-strings/">string</a>. The second argument, <code>lines</code>, represents the number of lines you want to retrieve from the end of the target file. Note that <code>lines</code> defaults to <code>10</code> to simulate the default behavior of <code>tail</code>.</p>
<p><strong>Note:</strong> The original idea for this example comes from the Python documentation on <code>deque</code>. Check out the section on <a href="https://docs.python.org/3/library/collections.html#deque-recipes"><code>deque</code> recipes</a> for further examples.</p>
<p>The deque in the highlighted line can only store up to the number of items you pass to <code>lines</code>. This guarantees that you get the desired number of lines from the end of the input file.</p>
<p>As you saw before, when you create a bounded deque and initialize it with an iterable the contains more items than allowed (<code>maxlen</code>), the <code>deque</code> constructor discards all the leftmost items in the input. Because of that, you end up with the last <code>maxlen</code> lines of the target file.</p>
<h3 id="conclusion">Conclusion</h3>
<p><a href="https://realpython.com/python-data-structures/#queues-fifos">Queues</a> and <a href="https://realpython.com/how-to-implement-python-stack/">stacks</a> are commonly used <strong>abstract data types</strong> in programming. They typically require efficient <strong>pop</strong> and <strong>append</strong> operations on either end of the underlying data structure. Python’s <a href="https://docs.python.org/3/library/collections.html#module-collections"><code>collections</code></a> module provides a data type called <a href="https://docs.python.org/3/library/collections.html#collections.deque"><code>deque</code></a> that’s specially designed for fast and memory-efficient append and pop operations on both ends.</p>
<p>With <code>deque</code>, you can code your own queues and stacks at a low level in an elegant, efficient, and Pythonic way.</p>
<p><strong>In this tutorial, you learned how to:</strong></p>
<ul>
<li>Create and use Python’s <strong><code>deque</code></strong> in your code</li>
<li>Efficiently <strong>append</strong> and <strong>pop</strong> items from both ends of a sequence with <code>deque</code></li>
<li>Use <code>deque</code> to build efficient <strong>queues</strong> and <strong>stacks</strong> in Python</li>
<li>Decide when to use <strong><code>deque</code></strong> instead of <strong><code>list</code></strong></li>
</ul>
<p>In this tutorial, you also coded a few examples that helped you approach some common use cases of <code>deque</code> in Python.</p>
</body>
</html>
